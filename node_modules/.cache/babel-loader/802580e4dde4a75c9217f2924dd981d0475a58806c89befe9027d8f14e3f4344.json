{"ast":null,"code":"import axios from \"axios\";\nimport { mapActions, mapState } from \"vuex\";\nexport default {\n  data() {\n    return {\n      avatarUrl: null,\n      editing: false,\n      editData: {\n        FULLNAME: \"\",\n        ADDRESS: \"\",\n        GENDER: \"\"\n      },\n      originalData: {}\n    };\n  },\n  computed: {\n    ...mapState([\"userInfo\"])\n  },\n  methods: {\n    ...mapActions([\"getUserInfo\"]),\n    editProfile() {\n      this.originalData = {\n        ...this.userInfo\n      };\n      this.editData = {\n        FULLNAME: this.userInfo.FULLNAME,\n        ADDRESS: this.userInfo.ADDRESS,\n        GENDER: this.userInfo.GENDER\n      };\n      this.editing = true;\n    },\n    async saveProfile() {\n      try {\n        const filteredEditData = this.filterEmptyFields(this.editData);\n        const updatedUser = await this.updateUserInfo(filteredEditData);\n        await this.getUserInfo();\n        this.editing = false;\n      } catch (error) {\n        console.error(\"Lỗi cập nhật thông tin:\", error.response?.data?.message || error.message);\n      }\n    },\n    filterEmptyFields(data) {\n      return Object.keys(data).filter(key => data[key] !== null && data[key] !== \"\").reduce((acc, key) => {\n        acc[key] = data[key];\n        return acc;\n      }, {});\n    },\n    async updateUserInfo(updatedUser) {\n      try {\n        const response = await axios.put(\"http://localhost:3000/user/updateUser\", updatedUser);\n        return response.data;\n      } catch (error) {\n        console.error(\"Lỗi cập nhật thông tin:\", error.response?.data?.message || error.message);\n        throw error;\n      }\n    },\n    handleFileUpload(event) {\n      const file = event.target.files[0];\n      this.uploadAvatar(file);\n    },\n    async uploadAvatar(file) {\n      const formData = new FormData();\n      formData.append(\"AVATAR\", file);\n      try {\n        const response = await axios.post(\"http://localhost:3000/azure/upload\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.avatarUrl = response.data.imageUrl;\n      } catch (error) {\n        console.error(\"Lỗi upload avatar:\", error);\n      }\n    },\n    updateEditData(field, value) {\n      this.editData[field] = value;\n    },\n    cancelEdit() {\n      this.editData = {\n        ...this.originalData\n      };\n      this.editing = false;\n    }\n  },\n  mounted() {\n    if (!this.userInfo) {\n      this.getUserInfo();\n    }\n  }\n};","map":{"version":3,"names":["axios","mapActions","mapState","data","avatarUrl","editing","editData","FULLNAME","ADDRESS","GENDER","originalData","computed","methods","editProfile","userInfo","saveProfile","filteredEditData","filterEmptyFields","updatedUser","updateUserInfo","getUserInfo","error","console","response","message","Object","keys","filter","key","reduce","acc","put","handleFileUpload","event","file","target","files","uploadAvatar","formData","FormData","append","post","headers","imageUrl","updateEditData","field","value","cancelEdit","mounted"],"sources":["D:\\Tiểu Luận Tốt Nghiệp\\Frontend\\src\\components\\Profie\\Profile.vue"],"sourcesContent":["<template>\n  <h2 class=\"title\">Thông Tin Cá Nhân</h2>\n  <div class=\"profile-container\">\n    <div class=\"profile-card\">\n      <div class=\"profile-title\">\n        <label for=\"avatarInput\">\n          <img\n            :src=\"userInfo?.AVATAR || avatarUrl || 'default-avatar.png'\"\n            alt=\"Avatar\"\n            class=\"avatar\"\n          />\n          <!-- <h4>{{ userInfo?.USERNAME }}</h4> -->\n        </label>\n        <input\n          id=\"avatarInput\"\n          type=\"file\"\n          style=\"display: none\"\n          ref=\"fileInput\"\n          @change=\"handleFileUpload\"\n        />\n      </div>\n      <div class=\"profile-info\">\n        <div class=\"info-item\">\n          <p>\n            <strong>Tên đăng nhập:</strong>\n            <span class=\"content\">{{ userInfo?.USERNAME }}</span>\n          </p>\n        </div>\n        <div class=\"info-item\">\n          <p>\n            <strong>Họ và tên:</strong>\n            <template v-if=\"!editing\">\n              <span class=\"content\">{{ userInfo?.FULLNAME }}</span>\n            </template>\n            <input\n              v-else\n              type=\"text\"\n              :value=\"editData.FULLNAME\"\n              @input=\"updateEditData('FULLNAME', $event.target.value)\"\n            />\n          </p>\n        </div>\n        <div class=\"info-item\">\n          <p>\n            <strong>Giới tính:</strong>\n            <template v-if=\"!editing\">\n              <span class=\"content\">{{ userInfo?.GENDER }}</span>\n            </template>\n            <select\n              v-else\n              :value=\"editData.GENDER\"\n              @change=\"updateEditData('GENDER', $event.target.value)\"\n            >\n              <option value=\"Male\">Male</option>\n              <option value=\"Female\">Female</option>\n              <option value=\"Other\">Other</option>\n            </select>\n          </p>\n        </div>\n        <div class=\"info-item\">\n          <p>\n            <strong>Địa chỉ:</strong>\n            <template v-if=\"!editing\">\n              <span class=\"content\">{{ userInfo?.ADDRESS }}</span>\n            </template>\n            <input\n              v-else\n              type=\"text\"\n              :value=\"editData.ADDRESS\"\n              @input=\"updateEditData('ADDRESS', $event.target.value)\"\n            />\n          </p>\n        </div>\n      </div>\n      <div class=\"action-buttons\">\n        <button v-if=\"!editing\" @click=\"editProfile\">Chỉnh sửa</button>\n        <button v-if=\"editing\" @click=\"saveProfile\">Lưu</button>\n        <button v-if=\"editing\" @click=\"cancelEdit\">Hủy</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport { mapActions, mapState } from \"vuex\";\n\nexport default {\n  data() {\n    return {\n      avatarUrl: null,\n      editing: false,\n      editData: {\n        FULLNAME: \"\",\n        ADDRESS: \"\",\n        GENDER: \"\",\n      },\n      originalData: {},\n    };\n  },\n  computed: {\n    ...mapState([\"userInfo\"]),\n  },\n  methods: {\n    ...mapActions([\"getUserInfo\"]),\n    editProfile() {\n      this.originalData = { ...this.userInfo };\n      this.editData = {\n        FULLNAME: this.userInfo.FULLNAME,\n        ADDRESS: this.userInfo.ADDRESS,\n        GENDER: this.userInfo.GENDER,\n      };\n      this.editing = true;\n    },\n    async saveProfile() {\n      try {\n        const filteredEditData = this.filterEmptyFields(this.editData);\n        const updatedUser = await this.updateUserInfo(filteredEditData);\n        await this.getUserInfo();\n        this.editing = false;\n      } catch (error) {\n        console.error(\n          \"Lỗi cập nhật thông tin:\",\n          error.response?.data?.message || error.message\n        );\n      }\n    },\n    filterEmptyFields(data) {\n      return Object.keys(data)\n        .filter((key) => data[key] !== null && data[key] !== \"\")\n        .reduce((acc, key) => {\n          acc[key] = data[key];\n          return acc;\n        }, {});\n    },\n    async updateUserInfo(updatedUser) {\n      try {\n        const response = await axios.put(\n          \"http://localhost:3000/user/updateUser\",\n          updatedUser\n        );\n        return response.data;\n      } catch (error) {\n        console.error(\n          \"Lỗi cập nhật thông tin:\",\n          error.response?.data?.message || error.message\n        );\n        throw error;\n      }\n    },\n    handleFileUpload(event) {\n      const file = event.target.files[0];\n      this.uploadAvatar(file);\n    },\n    async uploadAvatar(file) {\n      const formData = new FormData();\n      formData.append(\"AVATAR\", file);\n\n      try {\n        const response = await axios.post(\n          \"http://localhost:3000/azure/upload\",\n          formData,\n          {\n            headers: {\n              \"Content-Type\": \"multipart/form-data\",\n            },\n          }\n        );\n\n        this.avatarUrl = response.data.imageUrl;\n      } catch (error) {\n        console.error(\"Lỗi upload avatar:\", error);\n      }\n    },\n    updateEditData(field, value) {\n      this.editData[field] = value;\n    },\n    cancelEdit() {\n      this.editData = { ...this.originalData };\n      this.editing = false;\n    },\n  },\n  mounted() {\n    if (!this.userInfo) {\n      this.getUserInfo();\n    }\n  },\n};\n</script>\n\n<style scoped>\n.title {\n  font-size: 2rem;\n  margin-bottom: 20px;\n  text-align: center;\n}\n.profile-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n}\n\n.profile-card {\n  width: 80%;\n  padding: 40px; /* Tăng padding cho cảm giác thoáng hơn */\n  background-color: #f0f2f5;\n  margin-top: 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  border-radius: 10px;\n}\n\n.profile-title {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column; /* Đảm bảo tiêu đề và avatar xếp theo cột */\n  gap: 10px;\n  text-align: center;\n  margin-bottom: 20px;\n}\n\n.avatar {\n  margin-bottom: 10px;\n  width: 150px; /* Tăng kích thước lớn hơn nữa */\n  height: 150px; /* Tăng kích thước lớn hơn nữa */\n  border-radius: 50%;\n}\n\n.profile-info {\n  margin-top: 20px;\n}\n\n.info-item {\n  margin-bottom: 10px;\n  font-size: 16px;\n  text-align: left;\n}\n\n.info-item strong {\n  font-weight: bold;\n  font-size: 18px;\n}\n\n.info-item p {\n  font-size: 16px;\n}\n.info-item input,\n.info-item select {\n  width: 100%;\n  padding: 8px;\n  margin-top: 5px;\n  font-size: 16px;\n  border-radius: 4px;\n  border: 1px solid #ccc;\n}\n\n.action-buttons {\n  display: flex;\n  justify-content: center; /* Căn giữa các nút */\n  gap: 10px;\n}\n\nbutton {\n  padding: 10px 20px; /* Tăng kích thước nút */\n  border-radius: 5px; /* Làm nút trông tròn hơn */\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n}\n\nbutton:hover {\n  background-color: #1890ff;\n  color: white;\n}\n\n@media screen and (max-width: 768px) {\n  .profile-card {\n    width: 100%;\n  }\n}\n\n.content {\n  margin-left: 8px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}