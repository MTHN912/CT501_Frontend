{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-47bf2df0\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"cart-container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", null, \"Thực Đơn của Bạn\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"Đang tải dữ liệu...\", -1 /* HOISTED */));\nconst _hoisted_5 = [_hoisted_4];\nconst _hoisted_6 = {\n  key: 1,\n  class: \"cart-details\"\n};\nconst _hoisted_7 = {\n  class: \"cart-item-list\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"cart-item-info\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  class: \"cart-summary\"\n};\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"Tổng cộng\", -1 /* HOISTED */));\nconst _hoisted_12 = {\n  key: 2\n};\nconst _hoisted_13 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"Thực đơn của bạn đang trống.\", -1 /* HOISTED */));\nconst _hoisted_14 = [_hoisted_13];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createCommentVNode(\" Hiển thị thông báo đang tải nếu dữ liệu chưa tải xong \"), $data.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [..._hoisted_5])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" Hiển thị giỏ hàng khi dữ liệu đã tải xong \"), $data.cart && $data.cart.items && $data.cart.items.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"ul\", _hoisted_7, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cart.items, (item, index) => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: index,\n      class: \"cart-item\"\n    }, [item.dish ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [_createCommentVNode(\" Hiển thị thông tin món ăn khi dish tồn tại \"), _createElementVNode(\"h3\", null, _toDisplayString(item.dish.name), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Số lượng: \" + _toDisplayString(item.quantity), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Đơn giá: \" + _toDisplayString(item.dish.price) + \" đ\", 1 /* TEXT */), _createElementVNode(\"p\", null, \"Tổng giá: \" + _toDisplayString($options.itemTotalPrice(item)) + \" đ\", 1 /* TEXT */), _createElementVNode(\"button\", {\n      onClick: $event => $options.removeItem(item.dishId)\n    }, \"Bỏ món\", 8 /* PROPS */, _hoisted_9)])) : _createCommentVNode(\"v-if\", true)]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", _hoisted_10, [_hoisted_11, _createElementVNode(\"p\", null, \"Tổng số món: \" + _toDisplayString($options.totalQuantity), 1 /* TEXT */), _createElementVNode(\"p\", null, \"Tổng giá tất cả: \" + _toDisplayString($options.totalPrice) + \" đ\", 1 /* TEXT */)]), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.checkout && $options.checkout(...args)),\n    class: \"checkout-button\"\n  }, \"Đặt Bàn\")])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [..._hoisted_14]))]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","_hoisted_4","_hoisted_13","_createElementBlock","_hoisted_1","_hoisted_2","_createCommentVNode","$data","isLoading","_hoisted_3","_hoisted_5","cart","items","length","_hoisted_6","_hoisted_7","_Fragment","_renderList","item","index","dish","_hoisted_8","_toDisplayString","name","quantity","price","$options","itemTotalPrice","onClick","$event","removeItem","dishId","_hoisted_9","_hoisted_10","_hoisted_11","totalQuantity","totalPrice","_cache","args","checkout","_hoisted_12","_hoisted_14"],"sources":["D:\\Tiểu Luận Tốt Nghiệp\\Frontend\\src\\components\\Menu\\Cart.vue"],"sourcesContent":["<template>\n    <div class=\"cart-container\">\n      <h2>Thực Đơn của Bạn</h2>\n  \n      <!-- Hiển thị thông báo đang tải nếu dữ liệu chưa tải xong -->\n      <div v-if=\"isLoading\">\n        <p>Đang tải dữ liệu...</p>\n      </div>\n  \n      <!-- Hiển thị giỏ hàng khi dữ liệu đã tải xong -->\n      <div\n        v-if=\"cart && cart.items && cart.items.length > 0\"\n        class=\"cart-details\"\n      >\n        <ul class=\"cart-item-list\">\n          <li v-for=\"(item, index) in cart.items\" :key=\"index\" class=\"cart-item\">\n            <div class=\"cart-item-info\" v-if=\"item.dish\">\n              <!-- Hiển thị thông tin món ăn khi dish tồn tại -->\n              <h3>{{ item.dish.name }}</h3>\n              <p>Số lượng: {{ item.quantity }}</p>\n              <p>Đơn giá: {{ item.dish.price }} đ</p>\n              <p>Tổng giá: {{ itemTotalPrice(item) }} đ</p>\n              <button @click=\"removeItem(item.dishId)\">Bỏ món</button>\n            </div>\n          </li>\n        </ul>\n  \n        <div class=\"cart-summary\">\n          <h3>Tổng cộng</h3>\n          <p>Tổng số món: {{ totalQuantity }}</p>\n          <p>Tổng giá tất cả: {{ totalPrice }} đ</p>\n        </div>\n  \n        <button @click=\"checkout\" class=\"checkout-button\">Đặt Bàn</button>\n      </div>\n  \n      <div v-else>\n        <p>Thực đơn của bạn đang trống.</p>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from \"axios\";\n  \n  export default {\n    name: \"CartDetail\",\n    data() {\n      return {\n        cart: null, // Ban đầu cart là null, sẽ được gán dữ liệu từ server sau khi tải xong\n        isLoading: true, // Trạng thái đang tải dữ liệu\n      };\n    },\n    computed: {\n      totalQuantity() {\n        if (this.cart && this.cart.items) {\n          return this.cart.items.reduce(\n            (total, item) => total + item.quantity,\n            0\n          );\n        }\n        return 0;\n      },\n      totalPrice() {\n        if (this.cart && this.cart.items) {\n          return this.cart.items.reduce(\n            (total, item) => total + this.itemTotalPrice(item),\n            0\n          );\n        }\n        return 0;\n      },\n    },\n    methods: {\n      itemTotalPrice(item) {\n        if (item.dish) {\n          return item.quantity * item.dish.price;\n        }\n        return 0;\n      },\n      async removeItem(dishId) {\n        try {\n          if (!this.$store.getters.isLoggedIn) {\n            this.$router.push({ name: \"Login\" });\n            return;\n          }\n  \n          const token = this.$store.getters.userInfo.token;\n          const response = await axios.post(\n            \"http://localhost:3000/cart/removeCart\",\n            { dishId: dishId },\n            {\n              headers: {\n                Authorization: `Bearer ${token}`,\n              },\n            }\n          );\n          this.cart = response.data.cart;\n        } catch (error) {\n          console.error(\"Lỗi khi bỏ món:\", error);\n  \n          if (error.response && error.response.status === 401) {\n            this.$router.push({ name: \"Login\" });\n          }\n        }\n      },\n      async fetchCart() {\n        try {\n          if (!this.$store.getters.isLoggedIn) {\n            this.$router.push({ name: \"Login\" });\n            return;\n          }\n  \n          const token = this.$store.getters.userInfo.token;\n          const response = await axios.get(\"http://localhost:3000/cart/getCart\", {\n            headers: {\n              Authorization: `Bearer ${token}`,\n            },\n          });\n          this.cart = response.data.cart;\n        } catch (error) {\n          console.error(\"Lỗi khi tải giỏ hàng:\", error);\n  \n          if (error.response && error.response.status === 401) {\n            this.$router.push({ name: \"Login\" });\n          }\n        } finally {\n          this.isLoading = false;\n        }\n      },\n      checkout() {\n        this.$router.push({ name: \"Checkout\" });\n      },\n    },\n    mounted() {\n      if (!this.$store.getters.isLoggedIn) {\n        this.$router.push({ name: \"Login\" });\n      } else {\n        this.fetchCart();\n      }\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .cart-container {\n    padding: 20px;\n    max-width: 800px;\n    margin: 0 auto;\n  }\n  \n  .cart-item-list {\n    list-style: none;\n    padding: 0;\n  }\n  \n  .cart-item {\n    border-bottom: 1px solid #ddd;\n    padding: 10px 0;\n  }\n  \n  .cart-item-info {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n  \n  .cart-summary {\n    margin-top: 20px;\n    border-top: 1px solid #ddd;\n    padding-top: 10px;\n  }\n  \n  .checkout-button {\n    background-color: #28a745;\n    color: white;\n    border: none;\n    padding: 10px 20px;\n    cursor: pointer;\n    font-size: 16px;\n  }\n  \n  .checkout-button:hover {\n    background-color: #218838;\n  }\n  </style>\n  "],"mappings":";;;EACSA,KAAK,EAAC;AAAgB;gEACzBC,mBAAA,CAAyB,YAArB,kBAAgB;;EAF1BC,GAAA;AAAA;gEAMQD,mBAAA,CAA0B,WAAvB,qBAAmB;oBAAtBE,UAA0B,C;;EANlCD,GAAA;EAYQF,KAAK,EAAC;;;EAEFA,KAAK,EAAC;AAAgB;;EAdlCE,GAAA;EAgBiBF,KAAK,EAAC;;mBAhBvB;;EA2BaA,KAAK,EAAC;AAAc;iEACvBC,mBAAA,CAAkB,YAAd,WAAS;;EA5BvBC,GAAA;AAAA;iEAqCQD,mBAAA,CAAmC,WAAhC,8BAA4B;qBAA/BG,WAAmC,C;;uBApCvCC,mBAAA,CAsCM,OAtCNC,UAsCM,GArCJC,UAAyB,EAEzBC,mBAAA,2DAA8D,EACnDC,KAAA,CAAAC,SAAS,I,cAApBL,mBAAA,CAEM,OAPZM,UAAA,MAAAC,UAAA,MAAAJ,mBAAA,gBASMA,mBAAA,+CAAkD,EAE1CC,KAAA,CAAAI,IAAI,IAAIJ,KAAA,CAAAI,IAAI,CAACC,KAAK,IAAIL,KAAA,CAAAI,IAAI,CAACC,KAAK,CAACC,MAAM,Q,cAD/CV,mBAAA,CAwBM,OAxBNW,UAwBM,GApBJf,mBAAA,CAWK,MAXLgB,UAWK,I,kBAVHZ,mBAAA,CASKa,SAAA,QAxBfC,WAAA,CAesCV,KAAA,CAAAI,IAAI,CAACC,KAAK,EAfhD,CAesBM,IAAI,EAAEC,KAAK;yBAAvBhB,mBAAA,CASK;MAToCH,GAAG,EAAEmB,KAAK;MAAErB,KAAK,EAAC;QACvBoB,IAAI,CAACE,IAAI,I,cAA3CjB,mBAAA,CAOM,OAPNkB,UAOM,GANJf,mBAAA,gDAAmD,EACnDP,mBAAA,CAA6B,YAAAuB,gBAAA,CAAtBJ,IAAI,CAACE,IAAI,CAACG,IAAI,kBACrBxB,mBAAA,CAAoC,WAAjC,YAAU,GAAAuB,gBAAA,CAAGJ,IAAI,CAACM,QAAQ,kBAC7BzB,mBAAA,CAAuC,WAApC,WAAS,GAAAuB,gBAAA,CAAGJ,IAAI,CAACE,IAAI,CAACK,KAAK,IAAG,IAAE,iBACnC1B,mBAAA,CAA6C,WAA1C,YAAU,GAAAuB,gBAAA,CAAGI,QAAA,CAAAC,cAAc,CAACT,IAAI,KAAI,IAAE,iBACzCnB,mBAAA,CAAwD;MAA/C6B,OAAK,EAAAC,MAAA,IAAEH,QAAA,CAAAI,UAAU,CAACZ,IAAI,CAACa,MAAM;OAAG,QAAM,iBAtB7DC,UAAA,E,KAAA1B,mBAAA,e;oCA2BQP,mBAAA,CAIM,OAJNkC,WAIM,GAHJC,WAAkB,EAClBnC,mBAAA,CAAuC,WAApC,eAAa,GAAAuB,gBAAA,CAAGI,QAAA,CAAAS,aAAa,kBAChCpC,mBAAA,CAA0C,WAAvC,mBAAiB,GAAAuB,gBAAA,CAAGI,QAAA,CAAAU,UAAU,IAAG,IAAE,gB,GAGxCrC,mBAAA,CAAkE;IAAzD6B,OAAK,EAAAS,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEZ,QAAA,CAAAa,QAAA,IAAAb,QAAA,CAAAa,QAAA,IAAAD,IAAA,CAAQ;IAAExC,KAAK,EAAC;KAAkB,SAAO,E,oBAG3DK,mBAAA,CAEM,OAtCZqC,WAAA,MAAAC,WAAA,I","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}