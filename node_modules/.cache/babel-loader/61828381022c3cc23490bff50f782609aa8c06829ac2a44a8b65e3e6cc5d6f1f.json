{"ast":null,"code":"import axios from \"axios\";\nexport default {\n  name: \"CartDetail\",\n  data() {\n    return {\n      cart: {\n        items: []\n      },\n      // Khởi tạo với mảng rỗng\n      dishes: [] // Danh sách món ăn chi tiết\n    };\n  },\n  computed: {\n    // Tổng số lượng các món\n    totalQuantity() {\n      return this.cart.items.reduce((total, item) => total + item.quantity, 0);\n    },\n    // Tổng giá tiền của toàn bộ giỏ hàng\n    totalPrice() {\n      return this.cart.items.reduce((total, item) => total + itemTotalPrice(item), 0);\n    }\n  },\n  methods: {\n    // Tính tổng giá của một món\n    itemTotalPrice(item) {\n      return item.dish ? item.quantity * item.dish.price : 0;\n    },\n    // Xóa món khỏi giỏ hàng\n    async removeItem(dishId) {\n      try {\n        await axios.post(\"http://localhost:3000/cart/removeCart\", {\n          dishId\n        });\n        this.fetchCart(); // Lấy lại dữ liệu giỏ hàng sau khi xóa món\n      } catch (error) {\n        console.error(\"Lỗi khi bỏ món:\", error);\n      }\n    },\n    // Lấy dữ liệu giỏ hàng từ server\n    async fetchCart() {\n      try {\n        const response = await axios.get(\"http://localhost:3000/cart/getCart\");\n        this.cart = response.data.cart;\n        this.fetchDishes(); // Sau khi có giỏ hàng, lấy thông tin món ăn\n      } catch (error) {\n        console.error(\"Lỗi khi tải giỏ hàng:\", error);\n      }\n    },\n    // Lấy thông tin chi tiết các món ăn\n    async fetchDishes() {\n      try {\n        const dishIds = this.cart.items.map(item => item.dishId);\n        const response = await axios.post(\"http://localhost:3000/dish/getDishesByIds\", {\n          dishIds\n        });\n        this.dishes = response.data.dishes;\n\n        // Gắn thông tin món ăn vào giỏ hàng\n        this.cart.items = this.cart.items.map(item => ({\n          ...item,\n          dish: this.dishes.find(dish => dish.id === item.dishId)\n        }));\n      } catch (error) {\n        console.error(\"Lỗi khi tải thông tin món ăn:\", error);\n      }\n    },\n    // Xử lý đặt bàn\n    checkout() {\n      this.$router.push({\n        name: \"Checkout\"\n      });\n    }\n  },\n  mounted() {\n    this.fetchCart();\n  }\n};","map":{"version":3,"names":["axios","name","data","cart","items","dishes","computed","totalQuantity","reduce","total","item","quantity","totalPrice","itemTotalPrice","methods","dish","price","removeItem","dishId","post","fetchCart","error","console","response","get","fetchDishes","dishIds","map","find","id","checkout","$router","push","mounted"],"sources":["D:\\Tiểu Luận Tốt Nghiệp\\Frontend\\src\\components\\Menu\\Cart.vue"],"sourcesContent":["<template>\n    <div class=\"cart-container\">\n      <h2>Thực Đơn của Bạn</h2>\n  \n      <!-- Kiểm tra cart và cart.items để tránh lỗi -->\n      <div v-if=\"cart.items && cart.items.length > 0\" class=\"cart-details\">\n        <ul class=\"cart-item-list\">\n          <li v-for=\"(item, index) in cart.items\" :key=\"index\" class=\"cart-item\">\n            <div class=\"cart-item-info\">\n              <!-- Đảm bảo item.dish tồn tại trước khi truy cập thuộc tính -->\n              <h3>{{ item.dish ? item.dish.name : 'Tên món không có' }}</h3>\n              <p>Số lượng: {{ item.quantity }}</p>\n              <p>Đơn giá: {{ item.dish ? item.dish.price : '0' }} đ</p>\n              <p>Tổng giá: {{ itemTotalPrice(item) }} đ</p>\n              <button @click=\"removeItem(item.dishId)\">Bỏ món</button>\n            </div>\n          </li>\n        </ul>\n  \n        <div class=\"cart-summary\">\n          <h3>Tổng cộng</h3>\n          <p>Tổng số món: {{ totalQuantity }}</p>\n          <p>Tổng giá tất cả: {{ totalPrice }} đ</p>\n        </div>\n  \n        <button @click=\"checkout\" class=\"checkout-button\">Đặt Bàn</button>\n      </div>\n  \n      <div v-else>\n        <p>Thực đơn của bạn đang trống.</p>\n      </div>\n    </div>\n  </template>\n  \n  <script>\n  import axios from \"axios\";\n  \n  export default {\n    name: \"CartDetail\",\n    data() {\n      return {\n        cart: { items: [] }, // Khởi tạo với mảng rỗng\n        dishes: [], // Danh sách món ăn chi tiết\n      };\n    },\n    computed: {\n      // Tổng số lượng các món\n      totalQuantity() {\n        return this.cart.items.reduce((total, item) => total + item.quantity, 0);\n      },\n      // Tổng giá tiền của toàn bộ giỏ hàng\n      totalPrice() {\n        return this.cart.items.reduce(\n          (total, item) => total + itemTotalPrice(item),\n          0\n        );\n      },\n    },\n    methods: {\n      // Tính tổng giá của một món\n      itemTotalPrice(item) {\n        return item.dish ? item.quantity * item.dish.price : 0;\n      },\n  \n      // Xóa món khỏi giỏ hàng\n      async removeItem(dishId) {\n        try {\n          await axios.post(\"http://localhost:3000/cart/removeCart\", { dishId });\n          this.fetchCart(); // Lấy lại dữ liệu giỏ hàng sau khi xóa món\n        } catch (error) {\n          console.error(\"Lỗi khi bỏ món:\", error);\n        }\n      },\n  \n      // Lấy dữ liệu giỏ hàng từ server\n      async fetchCart() {\n        try {\n          const response = await axios.get(\"http://localhost:3000/cart/getCart\");\n          this.cart = response.data.cart;\n          this.fetchDishes(); // Sau khi có giỏ hàng, lấy thông tin món ăn\n        } catch (error) {\n          console.error(\"Lỗi khi tải giỏ hàng:\", error);\n        }\n      },\n  \n      // Lấy thông tin chi tiết các món ăn\n      async fetchDishes() {\n        try {\n          const dishIds = this.cart.items.map(item => item.dishId);\n          const response = await axios.post(\"http://localhost:3000/dish/getDishesByIds\", { dishIds });\n          this.dishes = response.data.dishes;\n  \n          // Gắn thông tin món ăn vào giỏ hàng\n          this.cart.items = this.cart.items.map(item => ({\n            ...item,\n            dish: this.dishes.find(dish => dish.id === item.dishId)\n          }));\n        } catch (error) {\n          console.error(\"Lỗi khi tải thông tin món ăn:\", error);\n        }\n      },\n  \n      // Xử lý đặt bàn\n      checkout() {\n        this.$router.push({ name: \"Checkout\" });\n      },\n    },\n    mounted() {\n      this.fetchCart();\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .cart-container {\n    padding: 20px;\n    max-width: 800px;\n    margin: 0 auto;\n  }\n  \n  .cart-item-list {\n    list-style: none;\n    padding: 0;\n  }\n  \n  .cart-item {\n    border-bottom: 1px solid #ddd;\n    padding: 10px 0;\n  }\n  \n  .cart-item-info {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n  \n  .cart-summary {\n    margin-top: 20px;\n    border-top: 1px solid #ddd;\n    padding-top: 10px;\n  }\n  \n  .checkout-button {\n    background-color: #28a745;\n    color: white;\n    border: none;\n    padding: 10px 20px;\n    cursor: pointer;\n    font-size: 16px;\n  }\n  \n  .checkout-button:hover {\n    background-color: #218838;\n  }\n  </style>\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}